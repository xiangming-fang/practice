<html class="ks-gecko109 ks-gecko ks-firefox112 ks-firefox"><!-- cph -->
<head>
    <!--    脚本 -->
    <script>
        function showButton() {
            var button = document.createElement("button");
            button.id = "down_ali_pics";
            button.value = "download";
            button.textContent = "download";
            document.body.appendChild(button);
            document.getElementById("down_ali_pics").addEventListener("click", () => {
                download();
            })
        }

        function download() {

            var protocol = "http:";
            var fmf = "_400x400.jpg";

            // 标题
            var elementById = document.getElementById("J_Title");
            var title = elementById.getElementsByClassName("tb-main-title")[0].getAttribute("data-title");
            title = title.substring(0, 12);
            console.log(title);

            // 主图
            var main_pics = document.getElementById("J_UlThumb");
            var lis = main_pics.getElementsByTagName("li");
            // 待下载主图名称数组[name,url]
            var pending_download_pic_name_urls = [];
            var k = 0;
            for (let i = 0; i < lis.length; i++) {
                var picUrl = lis[i].getElementsByTagName("img")[0].getAttribute("data-src");
                var suffix = picUrl.split(".");
                var name = (i+1) + "." + suffix[suffix.length - 1];
                var download_url = protocol + picUrl.substring(0, picUrl.length - 10);
                pending_download_pic_name_urls[k++] = [name,download_url];
            }

            // 颜色图
            var color_pics = document.getElementsByClassName("J_TSaleProp tb-img tb-clearfix")[0];
            var color_lis = color_pics.getElementsByTagName("li");
            for (let i = 0; i < color_lis.length; i++) {
                var color_picUrl = color_lis[i].getElementsByTagName("a")[0].getAttribute("style");
                var s = color_picUrl.indexOf("/");
                var l = color_picUrl.indexOf("jpg") + 3;
                color_picUrl = protocol + color_picUrl.substring(s, l) + fmf;
                var color = color_lis[i].getElementsByTagName("a")[0].getElementsByTagName("span")[0].textContent + ".jpg";
                pending_download_pic_name_urls[k++] = [color, color_picUrl];
            }
            for (let i = 0; i < pending_download_pic_name_urls.length; i++) {
                var fileName = pending_download_pic_name_urls[i][0];
                var url = pending_download_pic_name_urls[i][1];
                getBlob(url,fileName);
            }

        }

        // 第一步，要先通过当前url 取得 blob 对象（必须）
        async function getBlob(url, fileName) {
            // fetch 为ES6新增，不支持IE兼容，请注意分辨
            await fetch(url)
                .then((response) => {
                    return response.blob() // 转为文件流 请求类型类型 或其他类型
                })
                .then(res => {
                    let blob = new Blob([res]) // 转为blob
                    this.downloadFileName(blob, fileName) // 下载并重命名函数
                })
        }

        function downloadFileName(blob, fileName) {
            let link = document.createElement('a') // 创建a标签
            link.href = window.URL.createObjectURL(blob) // 获取blob 下载url
            link.download = fileName  // a标签新增属性  download 用于指定文件名
            link.click() // 点击下载
            URL.revokeObjectURL(link.href)
            document.body.removeChild(link)
        }

        window.onload = showButton;

    </script>
</head>

<body>
<ul id="J_UlThumb" class="tb-thumb tb-clearfix">


    <li class="" data-index="0">
        <div class="tb-pic tb-s50">
            <a href="#"><img
                    data-src="//gd1.alicdn.com/imgextra/i2/2212570412101/O1CN01uz9jBt1ROIwqeESEz_!!2212570412101.jpg_50x50.jpg"
                    src="//gd1.alicdn.com/imgextra/i2/2212570412101/O1CN01uz9jBt1ROIwqeESEz_!!2212570412101.jpg_50x50.jpg"></a>
        </div>
    </li>


    <li data-index="1">
        <div class="tb-pic tb-s50">
            <a href="#"><img
                    data-src="//gd2.alicdn.com/imgextra/i2/2212570412101/O1CN01CfCQtx1ROIwujVTVi_!!2212570412101.jpg_50x50.jpg"
                    src="//gd2.alicdn.com/imgextra/i2/2212570412101/O1CN01CfCQtx1ROIwujVTVi_!!2212570412101.jpg_50x50.jpg"></a>
        </div>
    </li>


    <li data-index="2">
        <div class="tb-pic tb-s50">
            <a href="#"><img
                    data-src="//gd1.alicdn.com/imgextra/i1/2212570412101/O1CN01qhZX1D1ROIwz7XBzU_!!2212570412101.jpg_50x50.jpg"
                    src="//gd1.alicdn.com/imgextra/i1/2212570412101/O1CN01qhZX1D1ROIwz7XBzU_!!2212570412101.jpg_50x50.jpg"></a>
        </div>
    </li>


    <li data-index="3">
        <div class="tb-pic tb-s50">
            <a href="#"><img
                    data-src="//gd1.alicdn.com/imgextra/i1/2212570412101/O1CN01agiTFT1ROIwxOV9Wm_!!2212570412101.jpg_50x50.jpg"
                    src="//gd1.alicdn.com/imgextra/i1/2212570412101/O1CN01agiTFT1ROIwxOV9Wm_!!2212570412101.jpg_50x50.jpg"></a>
        </div>
    </li>


    <li data-index="4">
        <div class="tb-pic tb-s50">
            <a href="#"><img
                    data-src="//gd2.alicdn.com/imgextra/i2/2212570412101/O1CN01xRJVsr1ROIwssUaN3_!!2212570412101.jpg_50x50.jpg"
                    src="//gd2.alicdn.com/imgextra/i2/2212570412101/O1CN01xRJVsr1ROIwssUaN3_!!2212570412101.jpg_50x50.jpg"></a>
        </div>
    </li>


</ul>

<div id="J_Title" class="tb-title" shortcut-key="t" shortcut-label="查看宝贝标题"
     shortcut-effect="focus">
    <h3 class="tb-main-title" data-title="OLEANA9083高腰开叉筷子裤女春季新款弹力百搭微喇牛仔裤拖地长裤">
        OLEANA9083高腰开叉筷子裤女春季新款弹力百搭微喇牛仔裤拖地长裤
    </h3>


    <p class="tb-subtitle"></p>
    <div id="J_TEditItem" class="tb-editor-menu">
        <div id="J_Report" class="tb-report"><p class="tb-report-hd">举报</p>
            <ul class="tb-report-bd">
                <li><a id="J_isuit"
                       href="//jubao.taobao.com/index.htm?&amp;spm=a1z6q.7847058&amp;itemId=704599051103"
                       target="_blank">举报此商品</a></li>
                <li>
                    <a href="//bbs.taobao.com/catalog/424023.htm?spm=2013.1.1000373.3"
                       target="_blank">购物安全防骗</a></li>
                <li><a href="//315.taobao.com?spm=2013.1.1000373.4"
                       target="_blank">消费质量曝光</a></li>
            </ul>
        </div>
    </div>
</div>

<ul data-property="颜色分类" class="J_TSaleProp tb-img tb-clearfix">

    <li data-value="1627207:28338" class="tb-selected">
        <a href="javascript:;"
           style="background:url(//gd3.alicdn.com/imgextra/i1/2212570412101/O1CN01Wj8Uhb1ROIwujYQZB_!!2212570412101.jpg_30x30.jpg) center no-repeat;">
            <span>蓝色</span>
        </a>
        <i>已选中</i>
    </li>


</ul>
</body>

</html>